<?xml version="1.0" encoding="UTF-8"?>
<pipeline>
  <info>
    <name>possible-bias-augmented</name>
    <name_sync_with_filename>Y</name_sync_with_filename>
    <description/>
    <extended_description/>
    <pipeline_version/>
    <pipeline_type>Normal</pipeline_type>
    <pipeline_status>0</pipeline_status>
    <parameters>
    </parameters>
    <capture_transform_performance>N</capture_transform_performance>
    <transform_performance_capturing_delay>1000</transform_performance_capturing_delay>
    <transform_performance_capturing_size_limit>100</transform_performance_capturing_size_limit>
    <created_user>-</created_user>
    <created_date>2023/12/18 15:00:31.032</created_date>
    <modified_user>-</modified_user>
    <modified_date>2023/12/18 15:00:31.032</modified_date>
  </info>
  <notepads>
  </notepads>
  <order>
    <hop>
      <from>augmented-taxonomies</from>
      <to>augmented-taxonomies parquet</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>augmented-taxonomies parquet</from>
      <to>Select taxonomies</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>augmented-taxonomies parquet</from>
      <to>Select taxonomies</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select taxonomies json</from>
      <to>cross product</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values</from>
      <to>cross product</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 2</from>
      <to>augmented-possible-bias</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>Sort</from>
      <to>Select values 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>cross product</from>
      <to>Taxonomy Labeller</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>english dataset parquet</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>english_dataset (clean)</from>
      <to>english dataset parquet</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>taxonomies json</from>
      <to>Select taxonomies json</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select taxonomies</from>
      <to>taxonomies json</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>cross product</from>
      <to>Taxonomy Labeller</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Taxonomy Labeller</from>
      <to>size contraints</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>size contraints</from>
      <to>Select values 3 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 3 2</from>
      <to>excluded_possible_bias</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 3</from>
      <to>Sort</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 2</from>
      <to>augmented-possible-bias</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Extract reason/suggestions</from>
      <to>terms_count_total</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>terms_count_total</from>
      <to>Select values 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>augmented-possible-bias</from>
      <to>terms_count_total > 0</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>terms_count_total > 0</from>
      <to>augmented-possible-bias-positive</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>terms_count_total > 0</from>
      <to>Negative</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>augmented-possible-bias-positive</from>
      <to>augmented-possible-bias-positive json</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>size contraints</from>
      <to>Extract reason/suggestions</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <transform>
    <name>Extract reason/suggestions</name>
    <type>SuperScript</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <length>-1</length>
        <name>domain_terms</name>
        <precision>-1</precision>
        <rename>domain_terms</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>provisional_terms</name>
        <precision>-1</precision>
        <rename>provisional_terms</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>synthetic_terms</name>
        <precision>-1</precision>
        <rename>synthetic_terms</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>terms_list_age</name>
        <precision>-1</precision>
        <rename>terms_list_age</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>reasons_list_age</name>
        <precision>-1</precision>
        <rename>reasons_list_age</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>suggestions_list_age</name>
        <precision>-1</precision>
        <rename>suggestions_list_age</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>terms_list_disability</name>
        <precision>-1</precision>
        <rename>terms_list_disability</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>reasons_list_disability</name>
        <precision>-1</precision>
        <rename>reasons_list_disability</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>suggestions_list_disability</name>
        <precision>-1</precision>
        <rename>suggestions_list_disability</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>terms_list_general</name>
        <precision>-1</precision>
        <rename>terms_list_general</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>reasons_list_general</name>
        <precision>-1</precision>
        <rename>reasons_list_general</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>suggestions_list_general</name>
        <precision>-1</precision>
        <rename>suggestions_list_general</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>terms_list_masculine</name>
        <precision>-1</precision>
        <rename>terms_list_masculine</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>reasons_list_masculine</name>
        <precision>-1</precision>
        <rename>reasons_list_masculine</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>suggestions_list_masculine</name>
        <precision>-1</precision>
        <rename>suggestions_list_masculine</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>terms_list_feminine</name>
        <precision>-1</precision>
        <rename>terms_list_feminine</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>reasons_list_feminine</name>
        <precision>-1</precision>
        <rename>reasons_list_feminine</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>suggestions_list_feminine</name>
        <precision>-1</precision>
        <rename>suggestions_list_feminine</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>terms_list_racial</name>
        <precision>-1</precision>
        <rename>terms_list_racial</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>reasons_list_racial</name>
        <precision>-1</precision>
        <rename>reasons_list_racial</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>suggestions_list_racial</name>
        <precision>-1</precision>
        <rename>suggestions_list_racial</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>terms_list_sexuality</name>
        <precision>-1</precision>
        <rename>terms_list_sexuality</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>reasons_list_sexuality</name>
        <precision>-1</precision>
        <rename>reasons_list_sexuality</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>suggestions_list_sexuality</name>
        <precision>-1</precision>
        <rename>suggestions_list_sexuality</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
    </fields>
    <scriptLanguage>python</scriptLanguage>
    <scripts>
      <script>
        <scriptBody>import json
from collections import defaultdict

try:
  hash_map
  source_term_count
except NameError:
  data = json.loads(taxonomies_json)

  # Create the hash map from the JSON string
  hash_map = {}
  source_term_count = defaultdict(int)

  for taxonomy in data['taxonomies']:
      key = (taxonomy['source'], taxonomy['category'], taxonomy['term'])

      if key not in hash_map:
        value = {
            'source': taxonomy['source'],
            'reason': taxonomy['reason'],
            'suggestions': taxonomy['suggestions']
        }
        hash_map[key] = value


def remove_synthetic_prefix(input_string):
    return ':'.join(input_string.split(':')[2:]) if input_string.startswith('synthetic:') else input_string


def parse_terms_list(category, terms_list):
  reasons = []
  suggestions = []
  terms = []

  for term in [word.strip('" ') for word in terms_list.split(',')]:
   if len(term) > 0:
     key = ('domain', category, term)
     if key not in hash_map:
       key = ('provisional', category, term)
       if key not in hash_map:
         key = ('synthetic', category, term)
     v = hash_map[key]
     r = v['reason']
     s = v['suggestions']
     #sources.add(v['source'])
     if 'domain' == key[0]:
       domain_terms.add(term)
     elif 'provisional' == key[0]:
       provisional_terms.add(term)
     if 'synthetic' == key[0]:
       synthetic_terms.add(term)

     terms.append(term)
     reasons.append(remove_synthetic_prefix(r))
     suggestions.append(remove_synthetic_prefix(s))


  terms_list = ', \n'.join(['[Term '+str(index+1) +']["'+word+'"]' for index, word in enumerate(terms)])
  reasons_list = ', \n'.join(['[Term '+str(index+1) +']['+word+']' for index, word in enumerate(reasons)])
  suggestions_list = ', \n'.join(['[Term '+str(index+1) +']['+word+']' for index, word in enumerate(suggestions)])

  return (terms_list, reasons_list, suggestions_list)


domain_terms = set()
provisional_terms = set()
synthetic_terms = set()

age = parse_terms_list('age', terms_list_age)
terms_list_age = age[0]
reasons_list_age = age[1]
suggestions_list_age = age[2]

disability = parse_terms_list('disability', terms_list_disability)
terms_list_disability = disability[0]
reasons_list_disability = disability[1]
suggestions_list_disability = disability[2]

general = parse_terms_list('general', terms_list_general)
terms_list_general = general[0]
reasons_list_general = general[1]
suggestions_list_general = general[2]

masculine = parse_terms_list('masculine', terms_list_masculine)
terms_list_masculine = masculine[0]
reasons_list_masculine = masculine[1]
suggestions_list_masculine = masculine[2]

feminine = parse_terms_list('feminine', terms_list_feminine)
terms_list_feminine = feminine[0]
reasons_list_feminine = feminine[1]
suggestions_list_feminine = feminine[2]

racial = parse_terms_list('racial', terms_list_racial)
terms_list_racial = racial[0]
reasons_list_racial = racial[1]
suggestions_list_racial = racial[2]

sexuality = parse_terms_list('sexuality', terms_list_sexuality)
terms_list_sexuality = sexuality[0]
reasons_list_sexuality = sexuality[1]
suggestions_list_sexuality = sexuality[2]


domain_terms = ', '.join(['"'+word+'"' for word in domain_terms])
provisional_terms = ', '.join(['"'+word+'"' for word in provisional_terms])
synthetic_terms = ', '.join(['"'+word+'"' for word in synthetic_terms])
</scriptBody>
        <scriptName>script1</scriptName>
        <scriptType>0</scriptType>
      </script>
    </scripts>
    <attributes/>
    <GUI>
      <xloc>1408</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Negative</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <GUI>
      <xloc>2496</xloc>
      <yloc>816</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select taxonomies</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>source</name>
      </field>
      <field>
        <name>category</name>
      </field>
      <field>
        <name>term</name>
      </field>
      <field>
        <name>reason</name>
      </field>
      <field>
        <name>suggestions</name>
      </field>
      <field>
        <name>reference</name>
      </field>
      <field>
        <name>comment</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>496</xloc>
      <yloc>416</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select taxonomies json</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>taxonomies_json</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>704</xloc>
      <yloc>560</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>document_id</name>
      </field>
      <field>
        <name>source</name>
      </field>
      <field>
        <name>country</name>
      </field>
      <field>
        <name>companyName</name>
        <rename>company</rename>
      </field>
      <field>
        <name>category</name>
      </field>
      <field>
        <name>position_name</name>
        <rename>position</rename>
      </field>
      <field>
        <name>job_posting</name>
      </field>
      <field>
        <name>job_posting_html</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>704</xloc>
      <yloc>800</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>document_id</name>
      </field>
      <field>
        <name>phrase_index</name>
      </field>
      <field>
        <name>phrase_series</name>
      </field>
      <field>
        <name>source</name>
      </field>
      <field>
        <name>country</name>
      </field>
      <field>
        <name>company</name>
      </field>
      <field>
        <name>position</name>
      </field>
      <field>
        <name>terms_count_total</name>
      </field>
      <field>
        <name>domain_terms</name>
      </field>
      <field>
        <name>provisional_terms</name>
      </field>
      <field>
        <name>synthetic_terms</name>
      </field>
      <field>
        <name>terms_count_age</name>
      </field>
      <field>
        <name>terms_list_age</name>
      </field>
      <field>
        <name>reasons_list_age</name>
      </field>
      <field>
        <name>suggestions_list_age</name>
      </field>
      <field>
        <name>terms_count_disability</name>
      </field>
      <field>
        <name>terms_list_disability</name>
      </field>
      <field>
        <name>reasons_list_disability</name>
      </field>
      <field>
        <name>suggestions_list_disability</name>
      </field>
      <field>
        <name>terms_count_general</name>
      </field>
      <field>
        <name>terms_list_general</name>
      </field>
      <field>
        <name>reasons_list_general</name>
      </field>
      <field>
        <name>suggestions_list_general</name>
      </field>
      <field>
        <name>terms_count_masculine</name>
      </field>
      <field>
        <name>terms_list_masculine</name>
      </field>
      <field>
        <name>reasons_list_masculine</name>
      </field>
      <field>
        <name>suggestions_list_masculine</name>
      </field>
      <field>
        <name>terms_count_feminine</name>
      </field>
      <field>
        <name>terms_list_feminine</name>
      </field>
      <field>
        <name>reasons_list_feminine</name>
      </field>
      <field>
        <name>suggestions_list_feminine</name>
      </field>
      <field>
        <name>terms_count_racial</name>
      </field>
      <field>
        <name>terms_list_racial</name>
      </field>
      <field>
        <name>reasons_list_racial</name>
      </field>
      <field>
        <name>suggestions_list_racial</name>
      </field>
      <field>
        <name>terms_count_sexuality</name>
      </field>
      <field>
        <name>terms_list_sexuality</name>
      </field>
      <field>
        <name>reasons_list_sexuality</name>
      </field>
      <field>
        <name>suggestions_list_sexuality</name>
      </field>
      <field>
        <name>phrase_character_count</name>
      </field>
      <field>
        <name>phrase_word_count</name>
      </field>
      <field>
        <name>phrase_max_word_count</name>
      </field>
      <field>
        <name>text</name>
      </field>
      <field>
        <name>html</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>2128</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values 3</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>document_id</name>
      </field>
      <field>
        <name>phrase_index</name>
      </field>
      <field>
        <name>phrase_series</name>
      </field>
      <field>
        <name>source</name>
      </field>
      <field>
        <name>country</name>
      </field>
      <field>
        <name>company</name>
      </field>
      <field>
        <name>position</name>
      </field>
      <field>
        <name>terms_count_total</name>
      </field>
      <field>
        <name>domain_terms</name>
      </field>
      <field>
        <name>provisional_terms</name>
      </field>
      <field>
        <name>synthetic_terms</name>
      </field>
      <field>
        <name>terms_count_age</name>
      </field>
      <field>
        <name>terms_list_age</name>
      </field>
      <field>
        <name>reasons_list_age</name>
      </field>
      <field>
        <name>suggestions_list_age</name>
      </field>
      <field>
        <name>terms_count_disability</name>
      </field>
      <field>
        <name>terms_list_disability</name>
      </field>
      <field>
        <name>reasons_list_disability</name>
      </field>
      <field>
        <name>suggestions_list_disability</name>
      </field>
      <field>
        <name>terms_count_general</name>
      </field>
      <field>
        <name>terms_list_general</name>
      </field>
      <field>
        <name>reasons_list_general</name>
      </field>
      <field>
        <name>suggestions_list_general</name>
      </field>
      <field>
        <name>terms_count_masculine</name>
      </field>
      <field>
        <name>terms_list_masculine</name>
      </field>
      <field>
        <name>reasons_list_masculine</name>
      </field>
      <field>
        <name>suggestions_list_masculine</name>
      </field>
      <field>
        <name>terms_count_feminine</name>
      </field>
      <field>
        <name>terms_list_feminine</name>
      </field>
      <field>
        <name>reasons_list_feminine</name>
      </field>
      <field>
        <name>suggestions_list_feminine</name>
      </field>
      <field>
        <name>terms_count_racial</name>
      </field>
      <field>
        <name>terms_list_racial</name>
      </field>
      <field>
        <name>reasons_list_racial</name>
      </field>
      <field>
        <name>suggestions_list_racial</name>
      </field>
      <field>
        <name>terms_count_sexuality</name>
      </field>
      <field>
        <name>terms_list_sexuality</name>
      </field>
      <field>
        <name>reasons_list_sexuality</name>
      </field>
      <field>
        <name>suggestions_list_sexuality</name>
      </field>
      <field>
        <name>phrase_character_count</name>
      </field>
      <field>
        <name>phrase_word_count</name>
      </field>
      <field>
        <name>phrase_max_word_count</name>
      </field>
      <field>
        <name>phrase_text</name>
        <rename>text</rename>
      </field>
      <field>
        <name>job_posting_html</name>
        <rename>html</rename>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1792</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values 3 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>document_id</name>
      </field>
      <field>
        <name>phrase_index</name>
      </field>
      <field>
        <name>phrase_series</name>
      </field>
      <field>
        <name>source</name>
      </field>
      <field>
        <name>country</name>
      </field>
      <field>
        <name>company</name>
      </field>
      <field>
        <name>position</name>
      </field>
      <field>
        <name>terms_count_age</name>
      </field>
      <field>
        <name>terms_list_age</name>
      </field>
      <field>
        <name>terms_count_disability</name>
      </field>
      <field>
        <name>terms_list_disability</name>
      </field>
      <field>
        <name>terms_count_general</name>
      </field>
      <field>
        <name>terms_list_general</name>
      </field>
      <field>
        <name>terms_count_masculine</name>
      </field>
      <field>
        <name>terms_list_masculine</name>
      </field>
      <field>
        <name>terms_count_feminine</name>
      </field>
      <field>
        <name>terms_list_feminine</name>
      </field>
      <field>
        <name>terms_count_racial</name>
      </field>
      <field>
        <name>terms_list_racial</name>
      </field>
      <field>
        <name>terms_count_sexuality</name>
      </field>
      <field>
        <name>terms_list_sexuality</name>
      </field>
      <field>
        <name>phrase_character_count</name>
      </field>
      <field>
        <name>phrase_word_count</name>
      </field>
      <field>
        <name>phrase_max_word_count</name>
      </field>
      <field>
        <name>phrase_text</name>
        <rename>text</rename>
      </field>
      <field>
        <name>job_posting_html</name>
        <rename>html</rename>
      </field>
      <field>
        <name>category</name>
      </field>
      <field>
        <name>job_posting</name>
      </field>
      <field>
        <name>taxonomies_json</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1088</xloc>
      <yloc>816</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Sort</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>${HOP_DATASETS_FOLDER}/tmp</directory>
    <prefix>out</prefix>
    <sort_size>1000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>source</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>document_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
      <field>
        <name>phrase_index</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1984</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Taxonomy Labeller</name>
    <type>TaxonomyLabeller</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <corpusField>job_posting</corpusField>
    <taxonomyField>taxonomies_json</taxonomyField>
    <taxonomyCategories>age,disability,general,masculine,feminine,racial,sexuality</taxonomyCategories>
    <taxonomyCategoriesDelimiter>,</taxonomyCategoriesDelimiter>
    <outputPhraseFieldNamePrefix>phrase_</outputPhraseFieldNamePrefix>
    <outputLabelFieldNamePrefix>terms_</outputLabelFieldNamePrefix>
    <outputMaxPhraseWordCount>400</outputMaxPhraseWordCount>
    <parallelism>0</parallelism>
    <ignoreCase>N</ignoreCase>
    <attributes/>
    <GUI>
      <xloc>896</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>augmented-possible-bias</name>
    <type>ParquetFileOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compression_codec>SNAPPY</compression_codec>
    <data_page_size>8192</data_page_size>
    <dictionary_page_size>1048576</dictionary_page_size>
    <fields>
      <field>
        <source_field>document_id</source_field>
        <target_field>document_id</target_field>
      </field>
      <field>
        <source_field>phrase_index</source_field>
        <target_field>phrase_index</target_field>
      </field>
      <field>
        <source_field>phrase_series</source_field>
        <target_field>phrase_series</target_field>
      </field>
      <field>
        <source_field>source</source_field>
        <target_field>source</target_field>
      </field>
      <field>
        <source_field>country</source_field>
        <target_field>country</target_field>
      </field>
      <field>
        <source_field>company</source_field>
        <target_field>company</target_field>
      </field>
      <field>
        <source_field>position</source_field>
        <target_field>position</target_field>
      </field>
      <field>
        <source_field>terms_count_total</source_field>
        <target_field>terms_count_total</target_field>
      </field>
      <field>
        <source_field>domain_terms</source_field>
        <target_field>domain_terms</target_field>
      </field>
      <field>
        <source_field>provisional_terms</source_field>
        <target_field>provisional_terms</target_field>
      </field>
      <field>
        <source_field>synthetic_terms</source_field>
        <target_field>synthetic_terms</target_field>
      </field>
      <field>
        <source_field>terms_count_age</source_field>
        <target_field>terms_count_age</target_field>
      </field>
      <field>
        <source_field>terms_list_age</source_field>
        <target_field>terms_list_age</target_field>
      </field>
      <field>
        <source_field>reasons_list_age</source_field>
        <target_field>reasons_list_age</target_field>
      </field>
      <field>
        <source_field>suggestions_list_age</source_field>
        <target_field>suggestions_list_age</target_field>
      </field>
      <field>
        <source_field>terms_count_disability</source_field>
        <target_field>terms_count_disability</target_field>
      </field>
      <field>
        <source_field>terms_list_disability</source_field>
        <target_field>terms_list_disability</target_field>
      </field>
      <field>
        <source_field>reasons_list_disability</source_field>
        <target_field>reasons_list_disability</target_field>
      </field>
      <field>
        <source_field>suggestions_list_disability</source_field>
        <target_field>suggestions_list_disability</target_field>
      </field>
      <field>
        <source_field>terms_count_general</source_field>
        <target_field>terms_count_general</target_field>
      </field>
      <field>
        <source_field>terms_list_general</source_field>
        <target_field>terms_list_general</target_field>
      </field>
      <field>
        <source_field>reasons_list_general</source_field>
        <target_field>reasons_list_general</target_field>
      </field>
      <field>
        <source_field>suggestions_list_general</source_field>
        <target_field>suggestions_list_general</target_field>
      </field>
      <field>
        <source_field>terms_count_masculine</source_field>
        <target_field>terms_count_masculine</target_field>
      </field>
      <field>
        <source_field>terms_list_masculine</source_field>
        <target_field>terms_list_masculine</target_field>
      </field>
      <field>
        <source_field>reasons_list_masculine</source_field>
        <target_field>reasons_list_masculine</target_field>
      </field>
      <field>
        <source_field>suggestions_list_masculine</source_field>
        <target_field>suggestions_list_masculine</target_field>
      </field>
      <field>
        <source_field>terms_count_feminine</source_field>
        <target_field>terms_count_feminine</target_field>
      </field>
      <field>
        <source_field>terms_list_feminine</source_field>
        <target_field>terms_list_feminine</target_field>
      </field>
      <field>
        <source_field>reasons_list_feminine</source_field>
        <target_field>reasons_list_feminine</target_field>
      </field>
      <field>
        <source_field>suggestions_list_feminine</source_field>
        <target_field>suggestions_list_feminine</target_field>
      </field>
      <field>
        <source_field>terms_count_racial</source_field>
        <target_field>terms_count_racial</target_field>
      </field>
      <field>
        <source_field>terms_list_racial</source_field>
        <target_field>terms_list_racial</target_field>
      </field>
      <field>
        <source_field>reasons_list_racial</source_field>
        <target_field>reasons_list_racial</target_field>
      </field>
      <field>
        <source_field>suggestions_list_racial</source_field>
        <target_field>suggestions_list_racial</target_field>
      </field>
      <field>
        <source_field>terms_count_sexuality</source_field>
        <target_field>terms_count_sexuality</target_field>
      </field>
      <field>
        <source_field>terms_list_sexuality</source_field>
        <target_field>terms_list_sexuality</target_field>
      </field>
      <field>
        <source_field>reasons_list_sexuality</source_field>
        <target_field>reasons_list_sexuality</target_field>
      </field>
      <field>
        <source_field>suggestions_list_sexuality</source_field>
        <target_field>suggestions_list_sexuality</target_field>
      </field>
      <field>
        <source_field>phrase_character_count</source_field>
        <target_field>phrase_character_count</target_field>
      </field>
      <field>
        <source_field>phrase_word_count</source_field>
        <target_field>phrase_word_count</target_field>
      </field>
      <field>
        <source_field>phrase_max_word_count</source_field>
        <target_field>phrase_max_word_count</target_field>
      </field>
      <field>
        <source_field>text</source_field>
        <target_field>text</target_field>
      </field>
      <field>
        <source_field>html</source_field>
        <target_field>html</target_field>
      </field>
    </fields>
    <filename_base>${HOP_DATASETS_FOLDER}/data-augmentation/augmented-possible-bias</filename_base>
    <filename_create_parent_folders>Y</filename_create_parent_folders>
    <filename_datetime_format>yyyyMMdd-HHmmss</filename_datetime_format>
    <filename_ext>parquet</filename_ext>
    <filename_include_copy>N</filename_include_copy>
    <filename_include_date>N</filename_include_date>
    <filename_include_datetime>N</filename_include_datetime>
    <filename_include_split>Y</filename_include_split>
    <filename_include_time>N</filename_include_time>
    <filename_split_size>500000</filename_split_size>
    <row_group_size>268435456</row_group_size>
    <version>2.0</version>
    <attributes/>
    <GUI>
      <xloc>2288</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>augmented-possible-bias-positive</name>
    <type>ParquetFileOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compression_codec>SNAPPY</compression_codec>
    <data_page_size>8192</data_page_size>
    <dictionary_page_size>1048576</dictionary_page_size>
    <fields>
      <field>
        <source_field>document_id</source_field>
        <target_field>document_id</target_field>
      </field>
      <field>
        <source_field>phrase_index</source_field>
        <target_field>phrase_index</target_field>
      </field>
      <field>
        <source_field>phrase_series</source_field>
        <target_field>phrase_series</target_field>
      </field>
      <field>
        <source_field>source</source_field>
        <target_field>source</target_field>
      </field>
      <field>
        <source_field>country</source_field>
        <target_field>country</target_field>
      </field>
      <field>
        <source_field>company</source_field>
        <target_field>company</target_field>
      </field>
      <field>
        <source_field>position</source_field>
        <target_field>position</target_field>
      </field>
      <field>
        <source_field>terms_count_total</source_field>
        <target_field>terms_count_total</target_field>
      </field>
      <field>
        <source_field>domain_terms</source_field>
        <target_field>domain_terms</target_field>
      </field>
      <field>
        <source_field>provisional_terms</source_field>
        <target_field>provisional_terms</target_field>
      </field>
      <field>
        <source_field>synthetic_terms</source_field>
        <target_field>synthetic_terms</target_field>
      </field>
      <field>
        <source_field>terms_count_age</source_field>
        <target_field>terms_count_age</target_field>
      </field>
      <field>
        <source_field>terms_list_age</source_field>
        <target_field>terms_list_age</target_field>
      </field>
      <field>
        <source_field>reasons_list_age</source_field>
        <target_field>reasons_list_age</target_field>
      </field>
      <field>
        <source_field>suggestions_list_age</source_field>
        <target_field>suggestions_list_age</target_field>
      </field>
      <field>
        <source_field>terms_count_disability</source_field>
        <target_field>terms_count_disability</target_field>
      </field>
      <field>
        <source_field>terms_list_disability</source_field>
        <target_field>terms_list_disability</target_field>
      </field>
      <field>
        <source_field>reasons_list_disability</source_field>
        <target_field>reasons_list_disability</target_field>
      </field>
      <field>
        <source_field>suggestions_list_disability</source_field>
        <target_field>suggestions_list_disability</target_field>
      </field>
      <field>
        <source_field>terms_count_general</source_field>
        <target_field>terms_count_general</target_field>
      </field>
      <field>
        <source_field>terms_list_general</source_field>
        <target_field>terms_list_general</target_field>
      </field>
      <field>
        <source_field>reasons_list_general</source_field>
        <target_field>reasons_list_general</target_field>
      </field>
      <field>
        <source_field>suggestions_list_general</source_field>
        <target_field>suggestions_list_general</target_field>
      </field>
      <field>
        <source_field>terms_count_masculine</source_field>
        <target_field>terms_count_masculine</target_field>
      </field>
      <field>
        <source_field>terms_list_masculine</source_field>
        <target_field>terms_list_masculine</target_field>
      </field>
      <field>
        <source_field>reasons_list_masculine</source_field>
        <target_field>reasons_list_masculine</target_field>
      </field>
      <field>
        <source_field>suggestions_list_masculine</source_field>
        <target_field>suggestions_list_masculine</target_field>
      </field>
      <field>
        <source_field>terms_count_feminine</source_field>
        <target_field>terms_count_feminine</target_field>
      </field>
      <field>
        <source_field>terms_list_feminine</source_field>
        <target_field>terms_list_feminine</target_field>
      </field>
      <field>
        <source_field>reasons_list_feminine</source_field>
        <target_field>reasons_list_feminine</target_field>
      </field>
      <field>
        <source_field>suggestions_list_feminine</source_field>
        <target_field>suggestions_list_feminine</target_field>
      </field>
      <field>
        <source_field>terms_count_racial</source_field>
        <target_field>terms_count_racial</target_field>
      </field>
      <field>
        <source_field>terms_list_racial</source_field>
        <target_field>terms_list_racial</target_field>
      </field>
      <field>
        <source_field>reasons_list_racial</source_field>
        <target_field>reasons_list_racial</target_field>
      </field>
      <field>
        <source_field>suggestions_list_racial</source_field>
        <target_field>suggestions_list_racial</target_field>
      </field>
      <field>
        <source_field>terms_count_sexuality</source_field>
        <target_field>terms_count_sexuality</target_field>
      </field>
      <field>
        <source_field>terms_list_sexuality</source_field>
        <target_field>terms_list_sexuality</target_field>
      </field>
      <field>
        <source_field>reasons_list_sexuality</source_field>
        <target_field>reasons_list_sexuality</target_field>
      </field>
      <field>
        <source_field>suggestions_list_sexuality</source_field>
        <target_field>suggestions_list_sexuality</target_field>
      </field>
      <field>
        <source_field>phrase_character_count</source_field>
        <target_field>phrase_character_count</target_field>
      </field>
      <field>
        <source_field>phrase_word_count</source_field>
        <target_field>phrase_word_count</target_field>
      </field>
      <field>
        <source_field>phrase_max_word_count</source_field>
        <target_field>phrase_max_word_count</target_field>
      </field>
      <field>
        <source_field>text</source_field>
        <target_field>text</target_field>
      </field>
      <field>
        <source_field>html</source_field>
        <target_field>html</target_field>
      </field>
    </fields>
    <filename_base>${HOP_DATASETS_FOLDER}/data-augmentation/augmented-possible-bias-positive</filename_base>
    <filename_create_parent_folders>Y</filename_create_parent_folders>
    <filename_datetime_format>yyyyMMdd-HHmmss</filename_datetime_format>
    <filename_ext>parquet</filename_ext>
    <filename_include_copy>N</filename_include_copy>
    <filename_include_date>N</filename_include_date>
    <filename_include_datetime>N</filename_include_datetime>
    <filename_include_split>Y</filename_include_split>
    <filename_include_time>N</filename_include_time>
    <filename_split_size>500000</filename_split_size>
    <row_group_size>268435456</row_group_size>
    <version>2.0</version>
    <attributes/>
    <GUI>
      <xloc>2720</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>augmented-possible-bias-positive json</name>
    <type>EnhancedJsonOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <outputValue>outputValue</outputValue>
    <jsonBloc/>
    <operation_type>writetofile</operation_type>
    <use_arrays_with_single_instance>N</use_arrays_with_single_instance>
    <use_single_item_per_group>N</use_single_item_per_group>
    <json_prittified>Y</json_prittified>
    <encoding>UTF-8</encoding>
    <addtoresult>N</addtoresult>
    <file>
      <name>${HOP_DATASETS_FOLDER}/data-augmentation/augmented-possible-bias-positive</name>
      <split_output_after>0</split_output_after>
      <extention>json</extention>
      <append>N</append>
      <split>N</split>
      <haspartno>N</haspartno>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <create_parent_folder>N</create_parent_folder>
      <doNotOpenNewFileInit>N</doNotOpenNewFileInit>
    </file>
    <additional_fields>
      <json_size_field/>
    </additional_fields>
    <key_fields>
    </key_fields>
    <fields>
      <field>
        <name>document_id</name>
        <element>document_id</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>phrase_index</name>
        <element>phrase_index</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>phrase_series</name>
        <element>phrase_series</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>source</name>
        <element>source</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>country</name>
        <element>country</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>company</name>
        <element>company</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>position</name>
        <element>position</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_count_total</name>
        <element>terms_count_total</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>domain_terms</name>
        <element>domain_terms</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>provisional_terms</name>
        <element>provisional_terms</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>synthetic_terms</name>
        <element>synthetic_terms</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_count_age</name>
        <element>terms_count_age</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_list_age</name>
        <element>terms_list_age</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>reasons_list_age</name>
        <element>reasons_list_age</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>suggestions_list_age</name>
        <element>suggestions_list_age</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_count_disability</name>
        <element>terms_count_disability</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_list_disability</name>
        <element>terms_list_disability</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>reasons_list_disability</name>
        <element>reasons_list_disability</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>suggestions_list_disability</name>
        <element>suggestions_list_disability</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_count_general</name>
        <element>terms_count_general</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_list_general</name>
        <element>terms_list_general</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>reasons_list_general</name>
        <element>reasons_list_general</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>suggestions_list_general</name>
        <element>suggestions_list_general</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_count_masculine</name>
        <element>terms_count_masculine</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_list_masculine</name>
        <element>terms_list_masculine</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>reasons_list_masculine</name>
        <element>reasons_list_masculine</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>suggestions_list_masculine</name>
        <element>suggestions_list_masculine</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_count_feminine</name>
        <element>terms_count_feminine</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_list_feminine</name>
        <element>terms_list_feminine</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>reasons_list_feminine</name>
        <element>reasons_list_feminine</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>suggestions_list_feminine</name>
        <element>suggestions_list_feminine</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_count_racial</name>
        <element>terms_count_racial</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_list_racial</name>
        <element>terms_list_racial</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>reasons_list_racial</name>
        <element>reasons_list_racial</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>suggestions_list_racial</name>
        <element>suggestions_list_racial</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_count_sexuality</name>
        <element>terms_count_sexuality</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>terms_list_sexuality</name>
        <element>terms_list_sexuality</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>reasons_list_sexuality</name>
        <element>reasons_list_sexuality</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>suggestions_list_sexuality</name>
        <element>suggestions_list_sexuality</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>phrase_character_count</name>
        <element>phrase_character_count</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>phrase_word_count</name>
        <element>phrase_word_count</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>phrase_max_word_count</name>
        <element>phrase_max_word_count</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>text</name>
        <element>text</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
      <field>
        <name>html</name>
        <element>html</element>
        <json_fragment>N</json_fragment>
        <is_without_enclosing>N</is_without_enclosing>
        <remove_if_blank>N</remove_if_blank>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>3008</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>augmented-taxonomies</name>
    <type>GetFileNames</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <doNotFailIfNoFile>N</doNotFailIfNoFile>
    <dynamic_include_subfolders>N</dynamic_include_subfolders>
    <file>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
      <name>${HOP_DATASETS_FOLDER}/data-augmentation/augmented-taxonomies-output.parquet.snappy</name>
    </file>
    <filefield>N</filefield>
    <filter>
      <filterfiletype>all_files</filterfiletype>
    </filter>
    <isaddresult>Y</isaddresult>
    <limit>0</limit>
    <raiseAnExceptionIfNoFile>N</raiseAnExceptionIfNoFile>
    <rownum>N</rownum>
    <attributes/>
    <GUI>
      <xloc>192</xloc>
      <yloc>288</yloc>
    </GUI>
  </transform>
  <transform>
    <name>augmented-taxonomies parquet</name>
    <type>ParquetFileInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <source_field>source</source_field>
        <target_field>source</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>category</source_field>
        <target_field>category</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>term</source_field>
        <target_field>term</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>reason</source_field>
        <target_field>reason</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>suggestions</source_field>
        <target_field>suggestions</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>reference</source_field>
        <target_field>reference</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>comment</source_field>
        <target_field>comment</target_field>
        <target_type>String</target_type>
      </field>
    </fields>
    <filename_field>filename</filename_field>
    <attributes/>
    <GUI>
      <xloc>496</xloc>
      <yloc>288</yloc>
    </GUI>
  </transform>
  <transform>
    <name>cross product</name>
    <type>JoinRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>${HOP_DATASETS_FOLDER}/tmp</directory>
    <prefix>out</prefix>
    <cache_size>500</cache_size>
    <main>Select values</main>
    <compare>
      <condition>
        <conditions>
</conditions>
        <function>=</function>
        <negated>N</negated>
        <operator>-</operator>
      </condition>
    </compare>
    <attributes/>
    <GUI>
      <xloc>704</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>english dataset parquet</name>
    <type>ParquetFileInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <source_field>document_id</source_field>
        <target_field>document_id</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>country</source_field>
        <target_field>country</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>locale</source_field>
        <target_field>locale</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>language</source_field>
        <target_field>language</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>source</source_field>
        <target_field>source</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>scraped_date</source_field>
        <target_field>scraped_date</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>company_id</source_field>
        <target_field>company_id</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>companyName</source_field>
        <target_field>companyName</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>city</source_field>
        <target_field>city</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>dataset_id</source_field>
        <target_field>dataset_id</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>dataset_type</source_field>
        <target_field>dataset_type</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>dataset_license</source_field>
        <target_field>dataset_license</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>dataset_source</source_field>
        <target_field>dataset_source</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>dataset_title</source_field>
        <target_field>dataset_title</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>dataset_url</source_field>
        <target_field>dataset_url</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>category</source_field>
        <target_field>category</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>position_name</source_field>
        <target_field>position_name</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>job_posting</source_field>
        <target_field>job_posting</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>job_posting_html</source_field>
        <target_field>job_posting_html</target_field>
        <target_type>String</target_type>
      </field>
    </fields>
    <filename_field>filename</filename_field>
    <attributes/>
    <GUI>
      <xloc>304</xloc>
      <yloc>800</yloc>
    </GUI>
  </transform>
  <transform>
    <name>english_dataset (clean)</name>
    <type>GetFileNames</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <doNotFailIfNoFile>N</doNotFailIfNoFile>
    <dynamic_include_subfolders>N</dynamic_include_subfolders>
    <file>
      <file_required>N</file_required>
      <filemask>english_clean_dataset-\d+\.parquet\.snappy</filemask>
      <include_subfolders>N</include_subfolders>
      <name>${HOP_DATASETS_FOLDER}/english</name>
    </file>
    <filefield>N</filefield>
    <filter>
      <filterfiletype>all_files</filterfiletype>
    </filter>
    <isaddresult>Y</isaddresult>
    <limit>0</limit>
    <raiseAnExceptionIfNoFile>N</raiseAnExceptionIfNoFile>
    <rownum>N</rownum>
    <attributes/>
    <GUI>
      <xloc>112</xloc>
      <yloc>800</yloc>
    </GUI>
  </transform>
  <transform>
    <name>excluded_possible_bias</name>
    <type>ParquetFileOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compression_codec>SNAPPY</compression_codec>
    <data_page_size>8192</data_page_size>
    <dictionary_page_size>1048576</dictionary_page_size>
    <fields>
      <field>
        <source_field>document_id</source_field>
        <target_field>document_id</target_field>
      </field>
      <field>
        <source_field>phrase_index</source_field>
        <target_field>phrase_index</target_field>
      </field>
      <field>
        <source_field>phrase_series</source_field>
        <target_field>phrase_series</target_field>
      </field>
      <field>
        <source_field>source</source_field>
        <target_field>source</target_field>
      </field>
      <field>
        <source_field>country</source_field>
        <target_field>country</target_field>
      </field>
      <field>
        <source_field>company</source_field>
        <target_field>company</target_field>
      </field>
      <field>
        <source_field>position</source_field>
        <target_field>position</target_field>
      </field>
      <field>
        <source_field>terms_count_age</source_field>
        <target_field>terms_count_age</target_field>
      </field>
      <field>
        <source_field>terms_list_age</source_field>
        <target_field>terms_list_age</target_field>
      </field>
      <field>
        <source_field>terms_count_disability</source_field>
        <target_field>terms_count_disability</target_field>
      </field>
      <field>
        <source_field>terms_list_disability</source_field>
        <target_field>terms_list_disability</target_field>
      </field>
      <field>
        <source_field>terms_count_general</source_field>
        <target_field>terms_count_general</target_field>
      </field>
      <field>
        <source_field>terms_list_general</source_field>
        <target_field>terms_list_general</target_field>
      </field>
      <field>
        <source_field>terms_count_masculine</source_field>
        <target_field>terms_count_masculine</target_field>
      </field>
      <field>
        <source_field>terms_list_masculine</source_field>
        <target_field>terms_list_masculine</target_field>
      </field>
      <field>
        <source_field>terms_count_feminine</source_field>
        <target_field>terms_count_feminine</target_field>
      </field>
      <field>
        <source_field>terms_list_feminine</source_field>
        <target_field>terms_list_feminine</target_field>
      </field>
      <field>
        <source_field>terms_count_racial</source_field>
        <target_field>terms_count_racial</target_field>
      </field>
      <field>
        <source_field>terms_list_racial</source_field>
        <target_field>terms_list_racial</target_field>
      </field>
      <field>
        <source_field>terms_count_sexuality</source_field>
        <target_field>terms_count_sexuality</target_field>
      </field>
      <field>
        <source_field>terms_list_sexuality</source_field>
        <target_field>terms_list_sexuality</target_field>
      </field>
      <field>
        <source_field>phrase_character_count</source_field>
        <target_field>phrase_character_count</target_field>
      </field>
      <field>
        <source_field>phrase_word_count</source_field>
        <target_field>phrase_word_count</target_field>
      </field>
      <field>
        <source_field>phrase_max_word_count</source_field>
        <target_field>phrase_max_word_count</target_field>
      </field>
      <field>
        <source_field>text</source_field>
        <target_field>text</target_field>
      </field>
      <field>
        <source_field>html</source_field>
        <target_field>html</target_field>
      </field>
    </fields>
    <filename_base>${HOP_DATASETS_FOLDER}/data-augmentation/excluded-augmented-possible-bias</filename_base>
    <filename_create_parent_folders>Y</filename_create_parent_folders>
    <filename_datetime_format>yyyyMMdd-HHmmss</filename_datetime_format>
    <filename_ext>parquet</filename_ext>
    <filename_include_copy>N</filename_include_copy>
    <filename_include_date>N</filename_include_date>
    <filename_include_datetime>N</filename_include_datetime>
    <filename_include_split>Y</filename_include_split>
    <filename_include_time>N</filename_include_time>
    <filename_split_size>500000</filename_split_size>
    <row_group_size>268435456</row_group_size>
    <version>2.0</version>
    <attributes/>
    <GUI>
      <xloc>1088</xloc>
      <yloc>928</yloc>
    </GUI>
  </transform>
  <transform>
    <name>size contraints</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compare>
      <condition>
        <conditions>
          <condition>
            <conditions>
</conditions>
            <function>&lt;=</function>
            <leftvalue>phrase_word_count</leftvalue>
            <negated>N</negated>
            <operator>-</operator>
            <rightvalue>phrase_max_word_count</rightvalue>
          </condition>
          <condition>
            <conditions>
</conditions>
            <function>&gt;</function>
            <leftvalue>phrase_word_count</leftvalue>
            <negated>N</negated>
            <operator>AND</operator>
            <value>
              <isnull>N</isnull>
              <length>-1</length>
              <mask>####0;-####0</mask>
              <name>constant</name>
              <precision>0</precision>
              <text>3</text>
              <type>Integer</type>
            </value>
          </condition>
          <condition>
            <conditions>
</conditions>
            <function>&gt;</function>
            <leftvalue>phrase_character_count</leftvalue>
            <negated>N</negated>
            <operator>AND</operator>
            <value>
              <isnull>N</isnull>
              <length>-1</length>
              <mask>####0;-####0</mask>
              <name>constant</name>
              <precision>0</precision>
              <text>10</text>
              <type>Integer</type>
            </value>
          </condition>
          <condition>
            <conditions>
</conditions>
            <function>&lt;=</function>
            <leftvalue>phrase_character_count</leftvalue>
            <negated>N</negated>
            <operator>AND</operator>
            <value>
              <isnull>N</isnull>
              <length>-1</length>
              <mask>####0;-####0</mask>
              <name>constant</name>
              <precision>0</precision>
              <text>3000</text>
              <type>Integer</type>
            </value>
          </condition>
          <condition>
            <conditions>
</conditions>
            <function>&lt;=</function>
            <leftvalue>phrase_series</leftvalue>
            <negated>N</negated>
            <operator>AND</operator>
            <value>
              <isnull>N</isnull>
              <length>-1</length>
              <mask>####0;-####0</mask>
              <name>constant</name>
              <precision>0</precision>
              <text>20</text>
              <type>Integer</type>
            </value>
          </condition>
        </conditions>
        <function>&lt;=</function>
        <leftvalue>phrase_word_count</leftvalue>
        <negated>N</negated>
        <operator>-</operator>
        <rightvalue>phrase_max_word_count</rightvalue>
      </condition>
    </compare>
    <send_false_to>Select values 3 2</send_false_to>
    <send_true_to>Extract reason/suggestions</send_true_to>
    <attributes/>
    <GUI>
      <xloc>1088</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>taxonomies json</name>
    <type>JsonOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <addToResult>N</addToResult>
    <createParentFolder>N</createParentFolder>
    <dateInFilename>N</dateInFilename>
    <doNotOpenNewFileInit>Y</doNotOpenNewFileInit>
    <encoding>UTF-8</encoding>
    <extension>json</extension>
    <fields>
      <field>
        <element>source</element>
        <name>source</name>
      </field>
      <field>
        <element>category</element>
        <name>category</name>
      </field>
      <field>
        <element>term</element>
        <name>term</name>
      </field>
      <field>
        <element>reason</element>
        <name>reason</name>
      </field>
      <field>
        <element>suggestions</element>
        <name>suggestions</name>
      </field>
      <field>
        <element>reference</element>
        <name>reference</name>
      </field>
      <field>
        <element>comment</element>
        <name>comment</name>
      </field>
    </fields>
    <fileAppended>N</fileAppended>
    <fileAsCommand>N</fileAsCommand>
    <jsonBloc>taxonomies</jsonBloc>
    <nrRowsInBloc>0</nrRowsInBloc>
    <operation_type>outputvalue</operation_type>
    <outputValue>taxonomies_json</outputValue>
    <partNrInFilename>N</partNrInFilename>
    <specifyingFormat>N</specifyingFormat>
    <timeInFilename>N</timeInFilename>
    <transformNrInFilename>N</transformNrInFilename>
    <attributes/>
    <GUI>
      <xloc>496</xloc>
      <yloc>560</yloc>
    </GUI>
  </transform>
  <transform>
    <name>terms_count_total</name>
    <type>SuperScript</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <length>-1</length>
        <name>terms_count_total</name>
        <precision>-1</precision>
        <rename>terms_count_total</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>Integer</type>
      </field>
    </fields>
    <scriptLanguage>ECMAScript</scriptLanguage>
    <scripts>
      <script>
        <scriptBody>terms_count_total = terms_count_age
                + terms_count_disability
                + terms_count_general
                + terms_count_masculine
                + terms_count_feminine
                + terms_count_racial
                + terms_count_sexuality</scriptBody>
        <scriptName>script1</scriptName>
        <scriptType>0</scriptType>
      </script>
    </scripts>
    <attributes/>
    <GUI>
      <xloc>1616</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform>
    <name>terms_count_total > 0</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compare>
      <condition>
        <conditions>
</conditions>
        <function>&gt;</function>
        <leftvalue>terms_count_total</leftvalue>
        <negated>N</negated>
        <operator>-</operator>
        <value>
          <isnull>N</isnull>
          <length>-1</length>
          <mask>####0;-####0</mask>
          <name>constant</name>
          <precision>0</precision>
          <text>0</text>
          <type>Integer</type>
        </value>
      </condition>
    </compare>
    <send_false_to>Negative</send_false_to>
    <send_true_to>augmented-possible-bias-positive</send_true_to>
    <attributes/>
    <GUI>
      <xloc>2496</xloc>
      <yloc>688</yloc>
    </GUI>
  </transform>
  <transform_error_handling>
  </transform_error_handling>
  <attributes/>
</pipeline>
