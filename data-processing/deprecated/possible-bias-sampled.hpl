<?xml version="1.0" encoding="UTF-8"?>
<pipeline>
  <info>
    <name>dataset_junk</name>
    <name_sync_with_filename>Y</name_sync_with_filename>
    <description/>
    <extended_description/>
    <pipeline_version/>
    <pipeline_type>Normal</pipeline_type>
    <pipeline_status>0</pipeline_status>
    <parameters>
    </parameters>
    <capture_transform_performance>N</capture_transform_performance>
    <transform_performance_capturing_delay>1000</transform_performance_capturing_delay>
    <transform_performance_capturing_size_limit>100</transform_performance_capturing_size_limit>
    <created_user>-</created_user>
    <created_date>2023/12/18 15:00:31.032</created_date>
    <modified_user>-</modified_user>
    <modified_date>2023/12/18 15:00:31.032</modified_date>
  </info>
  <notepads>
  </notepads>
  <order>
    <hop>
      <from>Switch / case</from>
      <to>Biased sampling</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case</from>
      <to>Unbiased sampling</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Switch / case</from>
      <to>dataset_junk_TO_REVIEW</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Unbiased sampling</from>
      <to>dataset_junk</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>gpt-4-turbo json</from>
      <to>gpt-4-turbo Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>gpt-4-turbo parquets</from>
      <to>gpt-4-turbo json</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>openai-gpt-4-turbo</from>
      <to>gpt-4-turbo parquets</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>gpt-4-turbo Select values</from>
      <to>Junk select</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Junk select</from>
      <to>mock_human</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>mock_human</from>
      <to>Select values 3</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 3</from>
      <to>human_polarity</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sentences</from>
      <to>Clean Sentence</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Clean Sentence</from>
      <to>Not Null</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Not Null</from>
      <to>Null</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Not Null</from>
      <to>Sort by context</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort by context</from>
      <to>Group by context</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Group by context</from>
      <to>Switch / case</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Group by context</from>
      <to>Text file output</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>human_polarity</from>
      <to>context_id</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>context_id</from>
      <to>Sentences</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Biased sampling</from>
      <to>human_polarity 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>human_polarity 2</from>
      <to>dataset_junk</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Group by context</from>
      <to>Select values 3 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values 3 2</from>
      <to>Text file output</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <transform>
    <name>Biased sampling</name>
    <type>ReservoirSampling</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <reservoir_sampling>
      <sample_size>500</sample_size>
      <seed>2024</seed>
    </reservoir_sampling>
    <attributes/>
    <GUI>
      <xloc>48</xloc>
      <yloc>736</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Clean Sentence</name>
    <type>SuperScript</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <length>-1</length>
        <name>sentence_text</name>
        <precision>-1</precision>
        <rename>sentence_text</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
    </fields>
    <scriptLanguage>Groovy</scriptLanguage>
    <scripts>
      <script>
        <scriptBody>import static org.apache.commons.lang3.StringUtils.*

sentence_text = trim(sentence_text)

end = [".","!","?"]

for(String e : end) {
if(endsWith(sentence_text,e)) {
	v = substringBeforeLast(sentence_text,e)
	v = trimToEmpty(v)
	if(endsWith(v,":")) {
		sentence_text = v
	} else {
		sentence_text = length(v) > 0 ? v + e: null
	}
}
}

if(sentence_text != null) {
letters = 0
final int sz = sentence_text.length();
for (int i = 0; i &lt; sz; i++) {
    if (Character.isLetter(sentence_text.charAt(i))) {
      letters++
    }
    if(letters > 2) {
	break;
    }
}

sentence_text = letters > 0 ? sentence_text : null
}</scriptBody>
        <scriptName>script1</scriptName>
        <scriptType>0</scriptType>
      </script>
    </scripts>
    <attributes/>
    <GUI>
      <xloc>768</xloc>
      <yloc>496</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Group by context</name>
    <type>GroupBy</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <add_linenr>N</add_linenr>
    <all_rows>N</all_rows>
    <directory>${java.io.tmpdir}</directory>
    <fields>
      <field>
        <aggregate>taxonomy_category</aggregate>
        <subject>taxonomy_category</subject>
        <type>FIRST_INCL_NULL</type>
      </field>
      <field>
        <aggregate>taxonomy_term</aggregate>
        <subject>taxonomy_term</subject>
        <type>FIRST_INCL_NULL</type>
      </field>
      <field>
        <aggregate>model_name</aggregate>
        <subject>model_name</subject>
        <type>FIRST_INCL_NULL</type>
      </field>
      <field>
        <aggregate>model_polarity</aggregate>
        <subject>model_polarity</subject>
        <type>FIRST_INCL_NULL</type>
      </field>
      <field>
        <aggregate>model_comment</aggregate>
        <subject>model_comment</subject>
        <type>FIRST_INCL_NULL</type>
      </field>
      <field>
        <aggregate>human_category</aggregate>
        <subject>human_category</subject>
        <type>FIRST_INCL_NULL</type>
      </field>
      <field>
        <aggregate>human_polarity</aggregate>
        <subject>human_polarity</subject>
        <type>FIRST_INCL_NULL</type>
      </field>
      <field>
        <aggregate>human_comment</aggregate>
        <subject>human_comment</subject>
        <type>FIRST_INCL_NULL</type>
      </field>
      <field>
        <aggregate>context</aggregate>
        <subject>sentence_text</subject>
        <type>CONCAT_STRING</type>
        <valuefield> </valuefield>
      </field>
      <field>
        <aggregate>html</aggregate>
        <subject>html</subject>
        <type>FIRST_INCL_NULL</type>
      </field>
    </fields>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>context_id</name>
      </field>
    </group>
    <ignore_aggregate>N</ignore_aggregate>
    <prefix>grp</prefix>
    <attributes/>
    <GUI>
      <xloc>352</xloc>
      <yloc>496</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Junk select</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>context_id</name>
      </field>
      <field>
        <name>term</name>
        <rename>model_term</rename>
      </field>
      <field>
        <name>category</name>
        <rename>model_category</rename>
      </field>
      <field>
        <name>polarity</name>
        <rename>model_polarity</rename>
      </field>
      <field>
        <name>reason</name>
        <rename>model_reason</rename>
      </field>
      <field>
        <name>model_name</name>
      </field>
      <field>
        <name>context</name>
      </field>
      <field>
        <name>html</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1056</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Not Null</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compare>
      <condition>
        <conditions>
</conditions>
        <function>IS NOT NULL</function>
        <leftvalue>sentence_text</leftvalue>
        <negated>N</negated>
        <operator>-</operator>
      </condition>
    </compare>
    <send_false_to>Null</send_false_to>
    <send_true_to>Sort by context</send_true_to>
    <attributes/>
    <GUI>
      <xloc>624</xloc>
      <yloc>496</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Null</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <GUI>
      <xloc>624</xloc>
      <yloc>624</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values 3</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>context_id</name>
      </field>
      <field>
        <name>model_category</name>
        <rename>taxonomy_category</rename>
      </field>
      <field>
        <name>model_term</name>
        <rename>taxonomy_term</rename>
      </field>
      <field>
        <name>model_name</name>
      </field>
      <field>
        <name>model_polarity</name>
      </field>
      <field>
        <name>model_reason</name>
        <rename>model_comment</rename>
      </field>
      <field>
        <name>human_polarity</name>
      </field>
      <field>
        <name>human_category</name>
      </field>
      <field>
        <name>human_comment</name>
      </field>
      <field>
        <name>context</name>
      </field>
      <field>
        <name>html</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1216</xloc>
      <yloc>384</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values 3 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>context_id</name>
        <rename/>
      </field>
      <field>
        <name>taxonomy_category</name>
        <rename/>
      </field>
      <field>
        <name>taxonomy_term</name>
        <rename/>
      </field>
      <field>
        <name>model_name</name>
        <rename/>
      </field>
      <field>
        <name>model_polarity</name>
        <rename/>
      </field>
      <field>
        <name>model_comment</name>
        <rename/>
      </field>
      <field>
        <name>human_category</name>
        <rename/>
      </field>
      <field>
        <name>human_polarity</name>
        <rename/>
      </field>
      <field>
        <name>human_comment</name>
        <rename/>
      </field>
      <field>
        <name>context</name>
        <rename/>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>192</xloc>
      <yloc>496</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Sentences</name>
    <type>StanfordSimpleNlp</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <corpusField>context</corpusField>
    <includePartOfSpeech>N</includePartOfSpeech>
    <parallelism>N</parallelism>
    <attributes/>
    <GUI>
      <xloc>928</xloc>
      <yloc>496</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Sort by context</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>${HOP_DATASETS_FOLDER}/tmp</directory>
    <prefix>out</prefix>
    <sort_size>1000000</sort_size>
    <free_memory/>
    <compress>N</compress>
    <compress_variable/>
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>context_id</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>0</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>496</xloc>
      <yloc>496</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Switch / case</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <case_value_type>String</case_value_type>
    <cases>
      <case>
        <target_transform>Biased sampling</target_transform>
        <value>biased</value>
      </case>
      <case>
        <target_transform>Unbiased sampling</target_transform>
        <value>unbiased</value>
      </case>
    </cases>
    <default_target_transform>dataset_junk_TO_REVIEW</default_target_transform>
    <fieldname>human_polarity</fieldname>
    <use_contains>N</use_contains>
    <attributes/>
    <GUI>
      <xloc>352</xloc>
      <yloc>736</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Text file output</name>
    <type>TextFileOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <separator>;</separator>
    <enclosure>"</enclosure>
    <enclosure_forced>N</enclosure_forced>
    <enclosure_fix_disabled>N</enclosure_fix_disabled>
    <header>Y</header>
    <footer>N</footer>
    <format>DOS</format>
    <compression>None</compression>
    <encoding>UTF-8</encoding>
    <endedLine/>
    <fileNameInField>N</fileNameInField>
    <fileNameField/>
    <create_parent_folder>Y</create_parent_folder>
    <file>
      <name>${HOP_DATASETS_FOLDER}/dataset_junk/dataset_junk</name>
      <servlet_output>N</servlet_output>
      <do_not_open_new_file_init>Y</do_not_open_new_file_init>
      <extention>txt</extention>
      <append>N</append>
      <split>N</split>
      <haspartno>N</haspartno>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <add_to_result_filenames>Y</add_to_result_filenames>
      <pad>N</pad>
      <fast_dump>N</fast_dump>
      <splitevery/>
    </file>
    <fields>
    </fields>
    <attributes/>
    <GUI>
      <xloc>192</xloc>
      <yloc>608</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Unbiased sampling</name>
    <type>ReservoirSampling</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <reservoir_sampling>
      <sample_size>500</sample_size>
      <seed>2024</seed>
    </reservoir_sampling>
    <attributes/>
    <GUI>
      <xloc>352</xloc>
      <yloc>880</yloc>
    </GUI>
  </transform>
  <transform>
    <name>context_id</name>
    <type>SuperScript</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <length>-1</length>
        <name>context_id</name>
        <precision>-1</precision>
        <rename>context_id</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
    </fields>
    <scriptLanguage>Groovy</scriptLanguage>
    <scripts>
      <script>
        <scriptBody>context_id = context_id + '::' + human_category</scriptBody>
        <scriptName>script1</scriptName>
        <scriptType>0</scriptType>
      </script>
    </scripts>
    <attributes/>
    <GUI>
      <xloc>1072</xloc>
      <yloc>496</yloc>
    </GUI>
  </transform>
  <transform>
    <name>dataset_junk</name>
    <type>ParquetFileOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compression_codec>SNAPPY</compression_codec>
    <data_page_size>8192</data_page_size>
    <dictionary_page_size>1048576</dictionary_page_size>
    <fields>
      <field>
        <source_field>context_id</source_field>
        <target_field>context_id</target_field>
      </field>
      <field>
        <source_field>taxonomy_category</source_field>
        <target_field>taxonomy_category</target_field>
      </field>
      <field>
        <source_field>taxonomy_term</source_field>
        <target_field>taxonomy_term</target_field>
      </field>
      <field>
        <source_field>model_name</source_field>
        <target_field>model_name</target_field>
      </field>
      <field>
        <source_field>model_polarity</source_field>
        <target_field>model_polarity</target_field>
      </field>
      <field>
        <source_field>model_comment</source_field>
        <target_field>model_comment</target_field>
      </field>
      <field>
        <source_field>human_polarity</source_field>
        <target_field>human_polarity</target_field>
      </field>
      <field>
        <source_field>human_category</source_field>
        <target_field>human_category</target_field>
      </field>
      <field>
        <source_field>human_comment</source_field>
        <target_field>human_comment</target_field>
      </field>
      <field>
        <source_field>context</source_field>
        <target_field>context</target_field>
      </field>
      <field>
        <source_field>html</source_field>
        <target_field>html</target_field>
      </field>
    </fields>
    <filename_base>${HOP_DATASETS_FOLDER}/dataset_junk/dataset_junk</filename_base>
    <filename_create_parent_folders>Y</filename_create_parent_folders>
    <filename_datetime_format>yyyyMMdd-HHmmss</filename_datetime_format>
    <filename_ext>parquet</filename_ext>
    <filename_include_copy>N</filename_include_copy>
    <filename_include_date>N</filename_include_date>
    <filename_include_datetime>N</filename_include_datetime>
    <filename_include_split>N</filename_include_split>
    <filename_include_time>N</filename_include_time>
    <filename_split_size>1000000</filename_split_size>
    <row_group_size>268435456</row_group_size>
    <version>2.0</version>
    <attributes/>
    <GUI>
      <xloc>352</xloc>
      <yloc>992</yloc>
    </GUI>
  </transform>
  <transform>
    <name>dataset_junk_TO_REVIEW</name>
    <type>ParquetFileOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compression_codec>SNAPPY</compression_codec>
    <data_page_size>8192</data_page_size>
    <dictionary_page_size>1048576</dictionary_page_size>
    <fields>
      <field>
        <source_field>context_id</source_field>
        <target_field>context_id</target_field>
      </field>
      <field>
        <source_field>taxonomy_category</source_field>
        <target_field>taxonomy_category</target_field>
      </field>
      <field>
        <source_field>taxonomy_term</source_field>
        <target_field>taxonomy_term</target_field>
      </field>
      <field>
        <source_field>model_name</source_field>
        <target_field>model_name</target_field>
      </field>
      <field>
        <source_field>model_polarity</source_field>
        <target_field>model_polarity</target_field>
      </field>
      <field>
        <source_field>model_comment</source_field>
        <target_field>model_comment</target_field>
      </field>
      <field>
        <source_field>human_polarity</source_field>
        <target_field>human_polarity</target_field>
      </field>
      <field>
        <source_field>human_category</source_field>
        <target_field>human_category</target_field>
      </field>
      <field>
        <source_field>human_comment</source_field>
        <target_field>human_comment</target_field>
      </field>
      <field>
        <source_field>context</source_field>
        <target_field>context</target_field>
      </field>
      <field>
        <source_field>html</source_field>
        <target_field>html</target_field>
      </field>
    </fields>
    <filename_base>${HOP_DATASETS_FOLDER}/dataset_junk/dataset_junk_TO_REVIEW</filename_base>
    <filename_create_parent_folders>Y</filename_create_parent_folders>
    <filename_datetime_format>yyyyMMdd-HHmmss</filename_datetime_format>
    <filename_ext>parquet</filename_ext>
    <filename_include_copy>N</filename_include_copy>
    <filename_include_date>N</filename_include_date>
    <filename_include_datetime>N</filename_include_datetime>
    <filename_include_split>N</filename_include_split>
    <filename_include_time>N</filename_include_time>
    <filename_split_size>1000000</filename_split_size>
    <row_group_size>268435456</row_group_size>
    <version>2.0</version>
    <attributes/>
    <GUI>
      <xloc>608</xloc>
      <yloc>736</yloc>
    </GUI>
  </transform>
  <transform>
    <name>gpt-4-turbo Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>context_id</name>
      </field>
      <field>
        <name>taxonomy_term</name>
        <rename>term</rename>
      </field>
      <field>
        <name>taxonomy_category</name>
        <rename>category</rename>
      </field>
      <field>
        <name>polarity</name>
      </field>
      <field>
        <name>reason</name>
      </field>
      <field>
        <name>model_name</name>
      </field>
      <field>
        <name>finish_reason</name>
      </field>
      <field>
        <name>context_measurement</name>
        <rename>metric</rename>
      </field>
      <field>
        <name>context_size</name>
        <rename>count</rename>
      </field>
      <field>
        <name>context_text</name>
        <rename>context</rename>
      </field>
      <field>
        <name>html</name>
      </field>
      <field>
        <name>prompt</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>864</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>gpt-4-turbo json</name>
    <type>JsonInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <include>N</include>
    <include_field/>
    <rownum>N</rownum>
    <addresultfile>N</addresultfile>
    <readurl>N</readurl>
    <removeSourceField>N</removeSourceField>
    <IsIgnoreEmptyFile>N</IsIgnoreEmptyFile>
    <doNotFailIfNoFile>Y</doNotFailIfNoFile>
    <ignoreMissingPath>Y</ignoreMissingPath>
    <defaultPathLeafToNull>Y</defaultPathLeafToNull>
    <rownum_field/>
    <file>
      <name/>
      <filemask/>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
    </file>
    <fields>
      <field>
        <name>polarity</name>
        <path>$.polarity</path>
        <type>Number</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>reason</name>
        <path>$.reason</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
    </fields>
    <limit>0</limit>
    <IsInFields>Y</IsInFields>
    <IsAFile>N</IsAFile>
    <valueField>detected_polarity</valueField>
    <shortFileFieldName/>
    <pathFieldName/>
    <hiddenFieldName/>
    <lastModificationTimeFieldName/>
    <uriNameFieldName/>
    <rootUriNameFieldName/>
    <extensionFieldName/>
    <sizeFieldName/>
    <attributes/>
    <GUI>
      <xloc>688</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>gpt-4-turbo parquets</name>
    <type>ParquetFileInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <source_field>context_id</source_field>
        <target_field>context_id</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>country</source_field>
        <target_field>country</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>company</source_field>
        <target_field>company</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>position</source_field>
        <target_field>position</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>taxonomy_term</source_field>
        <target_field>taxonomy_term</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>taxonomy_category</source_field>
        <target_field>taxonomy_category</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>context_measurement</source_field>
        <target_field>context_measurement</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>context_size</source_field>
        <target_field>context_size</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>detected_polarity</source_field>
        <target_field>detected_polarity</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>context_size_left_current</source_field>
        <target_field>context_size_left_current</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>context_size_left_target</source_field>
        <target_field>context_size_left_target</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>context_size_left_max</source_field>
        <target_field>context_size_left_max</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>context_size_right_current</source_field>
        <target_field>context_size_right_current</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>context_size_right_target</source_field>
        <target_field>context_size_right_target</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>context_size_right_max</source_field>
        <target_field>context_size_right_max</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>model_type</source_field>
        <target_field>model_type</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>model_name</source_field>
        <target_field>model_name</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>finish_reason</source_field>
        <target_field>finish_reason</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>input_token_count</source_field>
        <target_field>input_token_count</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>output_token_count</source_field>
        <target_field>output_token_count</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>total_token_count</source_field>
        <target_field>total_token_count</target_field>
        <target_type>Integer</target_type>
      </field>
      <field>
        <source_field>document_id</source_field>
        <target_field>document_id</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>context_text</source_field>
        <target_field>context_text</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>corpus</source_field>
        <target_field>corpus</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>html</source_field>
        <target_field>html</target_field>
        <target_type>String</target_type>
      </field>
      <field>
        <source_field>prompt</source_field>
        <target_field>prompt</target_field>
        <target_type>String</target_type>
      </field>
    </fields>
    <filename_field>filename</filename_field>
    <attributes/>
    <GUI>
      <xloc>496</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>human_polarity</name>
    <type>SuperScript</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <length>-1</length>
        <name>human_polarity</name>
        <precision>-1</precision>
        <rename>human_polarity</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
    </fields>
    <scriptLanguage>Groovy</scriptLanguage>
    <scripts>
      <script>
        <scriptBody>
switch(human_polarity) {
  case "yes":
    human_polarity = "biased"
    break;
  case "no":
    human_polarity = "unbiased"
    break;
}</scriptBody>
        <scriptName>script1</scriptName>
        <scriptType>0</scriptType>
      </script>
    </scripts>
    <attributes/>
    <GUI>
      <xloc>1216</xloc>
      <yloc>496</yloc>
    </GUI>
  </transform>
  <transform>
    <name>human_polarity 2</name>
    <type>SuperScript</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <length>-1</length>
        <name>human_polarity</name>
        <precision>-1</precision>
        <rename>human_polarity</rename>
        <replace>Y</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
    </fields>
    <scriptLanguage>Groovy</scriptLanguage>
    <scripts>
      <script>
        <scriptBody>human_polarity = human_category + ' ' + human_polarity</scriptBody>
        <scriptName>script1</scriptName>
        <scriptType>0</scriptType>
      </script>
    </scripts>
    <attributes/>
    <GUI>
      <xloc>48</xloc>
      <yloc>992</yloc>
    </GUI>
  </transform>
  <transform>
    <name>mock_human</name>
    <type>SuperScript</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <length>-1</length>
        <name>human_comment</name>
        <precision>-1</precision>
        <rename>human_comment</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>human_polarity</name>
        <precision>-1</precision>
        <rename>human_polarity</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>human_category</name>
        <precision>-1</precision>
        <rename>human_category</rename>
        <replace>N</replace>
        <scriptResult>N</scriptResult>
        <type>String</type>
      </field>
    </fields>
    <scriptLanguage>Groovy</scriptLanguage>
    <scripts>
      <script>
        <scriptBody>

human_comment = model_reason
human_polarity = model_polarity >= 0.5 ? 'yes' : 'no'
human_category = model_category</scriptBody>
        <scriptName>script1</scriptName>
        <scriptType>0</scriptType>
      </script>
    </scripts>
    <attributes/>
    <GUI>
      <xloc>1216</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>openai-gpt-4-turbo</name>
    <type>GetFileNames</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <doNotFailIfNoFile>N</doNotFailIfNoFile>
    <dynamic_include_subfolders>N</dynamic_include_subfolders>
    <file>
      <file_required>N</file_required>
      <filemask>llm_detected_polarity-\d+\.parquet\.snappy</filemask>
      <include_subfolders>N</include_subfolders>
      <name>${HOP_DATASETS_FOLDER}/llm_detected_polarity/openai-gpt-4-turbo</name>
    </file>
    <filefield>N</filefield>
    <filter>
      <filterfiletype>all_files</filterfiletype>
    </filter>
    <isaddresult>Y</isaddresult>
    <limit>0</limit>
    <raiseAnExceptionIfNoFile>N</raiseAnExceptionIfNoFile>
    <rownum>N</rownum>
    <attributes/>
    <GUI>
      <xloc>288</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform_error_handling>
  </transform_error_handling>
  <attributes/>
</pipeline>
